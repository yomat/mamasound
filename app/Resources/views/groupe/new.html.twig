<h2>Nouvel artiste</h2>

{{ form_start(form, {'attr': {'class': 'row1'}}) }}

    <div class="col-lg-3 fileContainer">
        <img id="groupe-image" class="row" src="{{ asset('images/mama.png') }}" alt="portrait de l'artiste" width="100%"/>
        {{ form_errors(form.image.file) }}
        Choisir le portrait
        <!--input id="groupe_image_file" name="groupe[image][file]" type="file" onchange="readURL(this);"-->
        {{ form_widget(form.image.file) }}
    </div>

    <div class="col-lg-9">

        <div class="form-group row">
            {{ form_errors(form.name) }}
            {{ form_label(form.name, 'Nom', {'label_attr': {'class': 'col-md-2 col-form-label'}}) }}
            <div class="col-md-10">
                {{ form_widget(form.name) }}
            </div>
        </div>

        <div class="form-group row">
            {{ form_errors(form.article) }}
            {{ form_label(form.article, 'Article', {'label_attr': {'class': 'col-md-2 col-form-label'}}) }}
            <div class="col-md-10">
                {{ form_widget(form.article) }}
            </div>
        </div>

    </div>

    <input type="submit" value="Enregistrer" class="col-lg-12"/>
{#{ form_widget(form) }#}
{{ form_end(form) }}



<div class="row1">
    <button class="btn"
            type="button"
            onclick="listEvents()">
        Retour aux événements
    </button>
</div>

<script>
    // Surcharge du submit -> ajax -> reponse -> modification du DOM

    // based on: http://codepen.io/tcannonfodder/pen/avJyRJ
    // based on: http://stackoverflow.com/a/9622978
    $('form[name="groupe"]').submit(function(e) {
        center_div = $('#center');
        e.preventDefault();
        var form = e.target;
        var data = new FormData(form);
        $.ajax({
                    url: $(this).attr("action"),
                    method: "POST",
                    processData: false,
                    contentType: false,
                    data: data
                })
                .done(function (data){
                    center_div.html(data);
                });
    });
</script>

<script>
    // Visualisation de l'image
    $(document).ready(function() {
        $('#groupe_image_file').change(function() {
            readURL($('#groupe_image_file'));
        });
    });

    function readURL(input) {
        var files = input.prop("files");
        if (files && files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#groupe-image')
                        .attr('src', e.target.result)
                        .width("100%")
                        .height("100%");
            };

            reader.readAsDataURL(files[0]);
        }
    }
</script>